---
phase: 03-workflow-integration
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - commands/gsd/execute-phase.md
  - agents/gsd-executor.md
autonomous: true

must_haves:
  truths:
    - "execute-phase command can reference user docs during execution"
    - "gsd-executor has on-demand access to user documentation"
    - "Missing USER-CONTEXT.md causes silent continue (no error)"
    - "Executor loads docs only when relevant to current task"
  artifacts:
    - path: "commands/gsd/execute-phase.md"
      provides: "User doc reference in executor spawn"
      contains: "USER-CONTEXT.md"
    - path: "agents/gsd-executor.md"
      provides: "On-demand user doc loading"
      contains: "user-provided-docs"
  key_links:
    - from: "commands/gsd/execute-phase.md"
      to: ".planning/codebase/USER-CONTEXT.md"
      via: "context reference in executor spawn"
      pattern: "USER-CONTEXT.md"
    - from: "agents/gsd-executor.md"
      to: "user docs"
      via: "on-demand loading during task execution"
      pattern: "<user-provided-docs>"
---

<objective>
Integrate validated user documentation into the execution workflow.

Purpose: Enable gsd-executor to access relevant user-provided documentation on-demand during plan execution. This fulfills WFL-02 and contributes to WFL-04 (smart selection via on-demand loading).

Output: Modified execute-phase.md command and gsd-executor.md agent that can load and use USER-CONTEXT.md when relevant to current tasks.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-workflow-integration/03-CONTEXT.md
@.planning/phases/03-workflow-integration/03-RESEARCH.md

# Files to modify
@commands/gsd/execute-phase.md
@agents/gsd-executor.md

# Reference pattern
@agents/gsd-doc-ingestor.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add user doc reference to execute-phase.md</name>
  <files>commands/gsd/execute-phase.md</files>
  <action>
Modify execute-phase.md to include USER-CONTEXT.md reference in executor spawn prompts.

Update the `<wave_execution>` section. In the Task spawn examples, add user docs reference:

Change:
```markdown
Task(prompt="Execute plan at {plan_01_path}\n\nPlan: @{plan_01_path}\nProject state: @.planning/STATE.md", subagent_type="gsd-executor")
```

To:
```markdown
Task(prompt="Execute plan at {plan_01_path}\n\nPlan: @{plan_01_path}\nProject state: @.planning/STATE.md\nUser docs (if available): @.planning/codebase/USER-CONTEXT.md", subagent_type="gsd-executor")
```

Add a note in the `<process>` section, after step 3 (Group by wave):

```markdown
3.5. **Check for user documentation**
   - Check if `.planning/codebase/USER-CONTEXT.md` exists
   - If exists: Include in executor spawn context (transparent to user)
   - If missing: Silent continue without user docs
```

The key principle: Execute-phase references the file; executor decides whether/when to load it.
  </action>
  <verify>
Read commands/gsd/execute-phase.md and confirm:
1. Wave execution Task spawns include USER-CONTEXT.md reference
2. New step 3.5 documents user doc check
3. No error handling or messages when file missing (silent continue)
  </verify>
  <done>execute-phase.md includes USER-CONTEXT.md reference in executor spawns</done>
</task>

<task type="auto">
  <name>Task 2: Add on-demand user doc loading to gsd-executor</name>
  <files>agents/gsd-executor.md</files>
  <action>
Modify gsd-executor.md to support on-demand loading of user documentation during task execution.

Add new section after `<deviation_rules>`:

```markdown
<user_documentation>
## User-Provided Documentation

**Location:** `.planning/codebase/USER-CONTEXT.md`

**Loading strategy:** On-demand - load when executor decides context would help.

**When to load user docs:**
- Starting a task that mentions patterns, conventions, or architecture
- Implementing something user docs likely cover (API endpoints, data models)
- Encountering ambiguity that user docs might clarify
- Following deviation rule 4 (architectural changes) - check if user docs have guidance

**Loading protocol:**
1. Check if file exists
2. If exists, read and extract relevant sections
3. Present in execution context as reference
4. If missing, silent continue (docs are optional)

**How to use in execution:**
- Follow documented conventions over inventing new ones
- Match user's preferred patterns
- Avoid contradicting existing documentation
- Weight by confidence: HIGH = follow strictly, MEDIUM = prefer, LOW = verify first

**Format when loading:**

\`\`\`markdown
<user-provided-docs>
[Relevant sections extracted based on current task context]
</user-provided-docs>
\`\`\`

**Important:** Do NOT load full USER-CONTEXT.md every time - load only when relevant sections would help the current task. Context budget matters.

**If no USER-CONTEXT.md:** Silent continue - this is normal if user never provided docs.
</user_documentation>
```

Update `<execution_flow>` step `load_plan`:

After "Parse:" bullet points, add:

```markdown
- User documentation reference (if included in spawn prompt)
```

And add note:

```markdown
**User documentation:** If orchestrator included USER-CONTEXT.md reference, it's available for on-demand loading. Load relevant sections when they would inform current task execution.
```
  </action>
  <verify>
Read agents/gsd-executor.md and confirm:
1. New `<user_documentation>` section exists after deviation_rules
2. On-demand loading strategy documented (not always-load)
3. When-to-load guidelines present
4. Confidence level handling documented
5. load_plan step mentions user docs
6. Silent continue when missing
  </verify>
  <done>gsd-executor can load USER-CONTEXT.md on-demand when relevant to current task execution</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. **File modifications verified:**
   - commands/gsd/execute-phase.md references USER-CONTEXT.md in spawns
   - agents/gsd-executor.md has user_documentation section

2. **On-demand pattern correct:**
   - Executor doesn't always load (would waste context)
   - Loads when current task would benefit
   - Guidelines for when to load are clear

3. **No breaking changes:**
   - Existing execute-phase workflow unchanged when no USER-CONTEXT.md
   - Executor still works without user docs
</verification>

<success_criteria>
- [ ] execute-phase.md includes USER-CONTEXT.md in executor spawn prompts
- [ ] gsd-executor.md can load user docs on-demand
- [ ] On-demand loading documented (not always-load)
- [ ] Missing USER-CONTEXT.md causes silent continue (no errors)
- [ ] Confidence level handling documented
</success_criteria>

<output>
After completion, create `.planning/phases/03-workflow-integration/03-02-SUMMARY.md`
</output>
